<p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog>
<div *ngIf="section1Flag" class="userForm">
    <p-accordion>
        <div class="p-col">
            <h3 style="text-align: center;padding-top: 12px;"  class="m-0 pt-1" >{{heading}}</h3>
        </div>
        <form [formGroup]="reportDateForm">
            <div class="p-field p-col-12 p-md-6">
                <span class="p-float-label">
            
                    <input pInputText  formControlName="dateOfReport" class="p-filled" *ngIf="e.dateOfReport.value" style="width: 50%;" dateFormat="dd-MM-yy" onfocus="(this.type='date')" onblur="(this.type='text')" >
                    <input pInputText  formControlName="dateOfReport"  *ngIf="!e.dateOfReport.value" style="width: 50%;" dateFormat="dd-MM-yy" onfocus="(this.type='date')" onblur="(this.type='text')" >
                    <label for="division">Date of Report<i class="required">*</i></label>
                </span>
                <div *ngIf="e.dateOfReport.invalid && (e.dateOfReport.touched)" class="error-msg">
                    <div *ngIf="e.dateOfReport.errors.required">Date of Report is required</div>
                </div>
            
            </div>
              
        </form>
        <p-accordionTab header="Part A: Ownership Pattern - TOP SHAREHOLDERS" [selected]="true">
            <form [formGroup]="section1Form">
                <div class="p-fluid p-formgrid p-grid pt-2">
                    <div class="p-field p-col-12 p-md-6 form-group" >
                        <span class="p-float-label">
                            <input id="float-input" type="number" (keypress)="numberOnlyWithDismal($event)" formControlName="totalNoOfEquityShares" pInputText> 
                            <label for="float-input">Total No. of Equity Shares</label>
                        </span>
                        <div *ngIf="f.totalNoOfEquityShares.invalid && (f.totalNoOfEquityShares.touched)" class="error-msg">
                            <div *ngIf="f.totalNoOfEquityShares.errors.required">Total No. of Equity Shares is required.</div>
                            </div>
                    </div>
                   <div class="p-field p-col-12 p-md-6" >
                        <span class="p-float-label">
                            <input pInputText type="text" (keypress)="numberOnlyWithDismal($event)" formControlName="faceValueOfEachShare">
                            <label for="division">Face Value of Each Share</label>
                        </span>
                        <div *ngIf="f.faceValueOfEachShare.invalid && (f.faceValueOfEachShare.touched)" class="error-msg">
                            <div *ngIf="f.faceValueOfEachShare.errors.required">Face Value of Each Share Shares is required.</div>
                            </div>
                    </div>
                   </div>
                   <div class="p-fluid p-formgrid p-grid pt-2">
                    <div class="p-field p-col-12 p-md-6 form-group" >
                        <span class="p-float-label">
                            <input pInputText type="text" (keypress)="numberOnlyWithDismal($event)" formControlName="bookValuePerShare" >
                            <label for="division">Book Value Per Share</label>
                        </span>
                        <div *ngIf="f.bookValuePerShare.invalid && (f.bookValuePerShare.touched)" class="error-msg">
                            <div *ngIf="f.bookValuePerShare.errors.required">Book Value Per Share is required.</div>
                            </div>
                    </div>
                   </div>
                   </form>
    
               <div class="card">
                <p-tabView>
                    <div class="p-grid" style="text-align:inital;">    
                        <div class="p-col text-right add" style="padding-bottom: 17px;">
                            <button pButton type="button" *ngIf="!isView && !isChecker" icon="pi pi-plus" iconPos="right" class="mr-2 " label="Add"
                                (click)="add('PartA',reportData)"></button>
                        </div>
                    </div>
                    <div class="SectionScroller">   
                    <p-table [columns]="cols" [value]="reportData" responsiveLayout="scroll"  dataKey="name" editMode="row" class="tableFixed" styleClass="p-datatable-gridlines top-20">
                       
                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" style="min-width: 300px;">
                                    {{col.name}}
                                </th>
                                <th *ngIf="!isView && !isChecker">Action</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-account let-ri="rowIndex">
                            <tr [pEditableRow]="account">
                                <ng-container>
                                    
                                    <td pEditableColumn *ngFor="let col of cols" style="min-width: 300px;height: 46px;"
                                    [ngClass]="{'disabled':(!col.editable)}"  [ngStyle]="{'background-color': !col.editable  ? '#dee2e6' :'#fff'}">
                                        <ng-container *ngIf="!col.editable ">
                                            {{col.title=="createdDate"?(account[col.title] | date :
                                            'dd-MM-yyyy'):account[col.title]}}
                                        </ng-container>
                                        <ng-container>
                                            {{col.edit}}
                                        </ng-container>
                                        <p-cellEditor *ngIf="(col.editable)"  >
                                            <ng-template pTemplate="input">
                                                <input pInputText [required]="col.required" [name]="col.title"
                                                [type]="col.inpType" [(ngModel)]="account[col.title]"  (change)="totaladdition(account,col,'PartA')"
                                                [min]="1" style="width:100%" *ngIf="col.title=='noOfHolders'" (keypress)="numberOnly($event)">

                                                <input pInputText [required]="col.required" [name]="col.title"
                                                [type]="col.inpType" [(ngModel)]="account[col.title]"  (change)="totaladdition(account,col,'PartA')"
                                                [min]="1" style="width:100%" *ngIf="col.title=='name'">

                                                <select class="p-dropdown-label p-inputtext ng-star-inserted selectLabel" style="width: 100%;" [name]="col.title" [(ngModel)]="account[col.title]" *ngIf="col.title=='status'"  >
                                                    <option value="Government of India">Government of India</option>
                                                    <option value="Reserve Bank of India">Reserve Bank of India</option>
                                                    <option value="Resient Financial Institution including Banks">Resient Financial Institution including Banks</option>
                                                    <option value="Resident Mutual Fund">Resident Mutual Fund</option>
                                                    <option value="Resident Para-Satal Public Sector Undertaking">Resident Para-Satal Public Sector Undertaking</option>
                                                    <option value="Resient Financial Institution including Banks">Resient Financial Institution including Banks</option>
                                                    <option value="Resident Private Corporate">Resident Private Corporate</option>
                                                    <option value="Resident Indian Individual">Resident Indian Individual</option>
                                                    <option value="Non-Resident Indian Individual">Non-Resident Indian Individual</option>
                                                    <option value="Non-Resident Indian Corporate">Non-Resident Indian Corporate</option>
                                                    <option value="Foreign Financial Institution">Foreign Financial Institution</option>
                                                    <option value="Foreign Corporate/Individual">Foreign Corporate/Individual</option>
                                                </select>

                                                <input pInputText [required]="col.required" [name]="col.title"
                                                    [type]="col.inpType" [(ngModel)]="account[col.title]"  (change)="totaladdition(account,col,'PartA')"
                                                    [min]="1" style="width:100%" *ngIf="col.title!='noOfHolders' && col.title!='name' && col.title!='status'" (keypress)="numberOnly($event)" >
    
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{col.title=="createdDate"?(account[col.title] | date :
                                                'dd-MM-yyyy'):account[col.title]}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>
                                    <td *ngIf="!isView && !isChecker">
                                        <i class="pi pi-trash text-danger"  (click)="delete(account,ri,'PartA')"></i>
                                    </td>
    
                            </ng-container>
                         </tr>
    
                    </ng-template>
                    <!-- <ng-template pTemplate="footer"  >
                        <tr style="background-color: gray;">
                            <ng-container >
                                <td><b>TOTAL</b></td>
                                <td></td>
                                <td></td>
                                <td>{{partATotal.sharesHeld}}</td>
                                <td>{{partATotal.sharesInTotalEquity | number:'1.2-2' | removeComma}}</td>
                                <td>{{partATotal.bookValueOfShares | number:'1.2-2' | removeComma}}</td>
                                <td>{{partATotal.faceValueOfShares | number:'1.2-2' | removeComma}}</td>
                                <td></td>
                                <td></td>
                                <td *ngIf="!isView && !isChecker"></td>
                              
                                
                            </ng-container> 
                        </tr>
                        
                    </ng-template> -->
                    </p-table>
                    </div>
                </p-tabView>
            </div>
            <p style="font-size: 13px;">Note: All shareholders who have holding of 1% or more of the total equity shares are to be reported</p>   
        </p-accordionTab>
        <p-accordionTab header="Part B: Other Shareholders" >
            <div class="card">
                <p-tabView>
                   
                    <div class="SectionScroller">   
                    <p-table [columns]="PartBcols" [value]="reportBData" responsiveLayout="scroll"  dataKey="name" editMode="row" class="tableFixed" styleClass="p-datatable-gridlines top-20">
                       
                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" [ngStyle]="{'width':col.width}">
                                    {{col.name}}
                                </th>
                                <!-- <th>Action</th> -->
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-account let-ri="rowIndex">
                           
                            <tr [pEditableRow]="account">
                                <ng-container>
                                   
                                    <td pEditableColumn *ngFor="let col of PartBcols" style="min-width: 300px;height: 46px;"
                                    [ngClass]="{'disabled':(!col.editable)}"  [ngStyle]="{'background-color': !col.editable  ? '#dee2e6' :'#fff'}">
                                        <ng-container *ngIf="!col.editable ">
                                            {{col.title=="createdDate"?(account[col.title] | date :
                                            'dd-MM-yyyy'):account[col.title]}}
                                        </ng-container>
                                        <ng-container>
                                            {{col.edit}}
                                        </ng-container>
                                        <p-cellEditor *ngIf="(col.editable)"  >
                                            <ng-template pTemplate="input">
                                                
                                                <input pInputText [required]="col.required" [name]="col.title"
                                                    [type]="col.inpType" [(ngModel)]="account[col.title]" (change)="totaladdition(account,col,'PartB')"
                                                    [min]="1" style="width:100%" *ngIf="col.title=='noofholders' || col.title=='sharesHeld'" (keypress)="numberOnly($event)"  >
                                                  
                                                    <input pInputText [required]="col.required" [name]="col.title"
                                                    [type]="col.inpType" [(ngModel)]="account[col.title]" (change)="totaladdition(account,col,'PartB')"
                                                    [min]="1" style="width:100%" (keypress)="numberOnlyWithDismal($event)"  *ngIf="col.title!='noofholders' && col.title!='sharesHeld'">

                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{col.title=="createdDate"?(account[col.title] | date :
                                                'dd-MM-yyyy'):account[col.title]}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>
                                    <!-- <td >
                                        <i class="pi pi-trash text-danger" (click)="delete(ri,'PartB')"></i>
                                    </td> -->
    
                            </ng-container>
                         </tr> 
    
                    </ng-template>
                    <!-- <ng-template pTemplate="footer"  >
                        <tr style="background-color: gray;">
                            <ng-container >
                                <td><b>TOTAL</b></td>
                                <td>{{partBTotal.noOfHolders}}</td>
                                <td>{{partBTotal.sharesHeld}}</td>
                                <td>{{partBTotal.sharesInTotalEquity | number:'1.2-2' | removeComma}}</td>
                                <td>{{partBTotal.bookValueOfShares | number:'1.2-2' | removeComma}}</td>
                                <td>{{partBTotal.faceValueOfShares | number:'1.2-2' | removeComma}}</td>
                                <td></td>
                                <td></td>
                             
                                
                            </ng-container> 
                        </tr>
                        
                    </ng-template> -->
                    </p-table>
                    </div>
                </p-tabView>
            </div>
        </p-accordionTab>
        <p-accordionTab header="Part C: Ownership Summary" >
            <div class="card">
                <p-tabView>
                  
                    <div class="SectionScroller">   
                    <p-table [columns]="PartCcols" [value]="reportCData" responsiveLayout="scroll"  dataKey="name" editMode="row" class="tableFixed" styleClass="p-datatable-gridlines top-20">
                       
                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" [ngStyle]="{'width':col.width}">
                                    {{col.name}}
                                </th>
                                <!-- <th>Action</th> -->
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-account let-ri="rowIndex">
                            <tr [pEditableRow]="account">
                                <ng-container>
                                    
                                    <td pEditableColumn *ngFor="let col of PartCcols" style="min-width: 300px;height: 46px;"
                                    [ngClass]="{'disabled':(!col.editable)}"  [ngStyle]="{'background-color': !col.editable  ? '#dee2e6' :'#fff'}">
                                        <ng-container *ngIf="!col.editable ">
                                            {{col.title=="createdDate"?(account[col.title] | date :
                                            'dd-MM-yyyy'):account[col.title]}}
                                        </ng-container>
                                        <ng-container>
                                            {{col.edit}}
                                        </ng-container>
                                        <p-cellEditor *ngIf="(col.editable)"  >
                                            <ng-template pTemplate="input">
                                                <input pInputText [required]="col.required" [name]="col.title"
                                                    [type]="col.inpType" [(ngModel)]="account[col.title]"  (change)="totaladdition(account,col,'PartC')"
                                                    [min]="1" style="width:100%" (keypress)="numberOnlyWithDismal($event)" >
    
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{col.title=="createdDate"?(account[col.title] | date :
                                                'dd-MM-yyyy'):account[col.title]}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>
                                    <!-- <td >
                                        <i class="pi pi-trash text-danger" (click)="delete(ri,'PartC')"></i>
                                    </td> -->
    
                            </ng-container>
                         </tr>
    
                    </ng-template>
                    <!-- <ng-template pTemplate="footer"  >
                        <tr style="background-color: gray;">
                            <ng-container >
                                <td><b>TOTAL</b></td>
                                <td>{{partCTotal.resident | number:'1.2-2' | removeComma}}</td>
                                <td>{{partCTotal.nonResident | number:'1.2-2' | removeComma}}</td>
                                <td></td>
                                <td></td>
                            </ng-container> 
                        </tr>
                        
                    </ng-template> -->
                    </p-table>
                    </div>
                </p-tabView>
            </div>   
        </p-accordionTab>
        <p-accordionTab header="Part D: Shareholder Control (Extent of Control)" >
            <div class="card">
                <p-tabView>
                    <div class="p-grid" style="text-align:inital;">    
                        <div class="p-col text-right add" style="padding-bottom: 17px;">
                            <button pButton type="button" *ngIf="!isView && !isChecker"   icon="pi pi-plus" iconPos="right" class="mr-2 " label="Add"
                                (click)="add('PartD',reportDData)"></button>
                        </div>
                    </div>
                    <div class="SectionScroller">
                    <p-table [columns]="PartDcols" [value]="reportDData" responsiveLayout="scroll"  dataKey="name" editMode="row" class="tableFixed" styleClass="p-datatable-gridlines top-20">
                       
                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" style="min-width: 300px;">
                                    {{col.name}}
                                </th>
                                <th  *ngIf="!isView && !isChecker">Action</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-account let-ri="rowIndex">
                            <tr [pEditableRow]="account">
                                <ng-container>
                                    
                                    <td pEditableColumn *ngFor="let col of PartDcols" style="min-width: 300px;height: 46px;"
                                    [ngClass]="{'disabled':(!col.editable)}"  [ngStyle]="{'background-color': !col.editable  ? '#dee2e6' :'#fff'}">
                                        <ng-container *ngIf="!col.editable ">
                                            {{col.title=="createdDate"?(account[col.title] | date :
                                            'dd-MM-yyyy'):account[col.title]}}
                                        </ng-container>
                                        <ng-container>
                                            {{col.edit}}
                                        </ng-container>
                                        <p-cellEditor *ngIf="(col.editable)"  >
                                            <ng-template pTemplate="input">
                                                <input pInputText [required]="col.required" [name]="col.title"
                                                    [type]="col.inpType" [(ngModel)]="account[col.title]" (change)="totaladdition(account,col,'PartD')"
                                                    [min]="1" style="width:100%" *ngIf="col.title=='noOfSharesHeld'" (keypress)="numberOnly($event)">
                                                    <select class="p-dropdown-label p-inputtext ng-star-inserted selectLabel" style="width: 100%;" [name]="col.title" [(ngModel)]="account[col.title]" *ngIf="col.title=='residenceStatus'"  >
                                                        <option value="Resident">Resident</option>
                                                        <option value="Non Resident">Non Resident</option>
                                                        <option value="Not Applicable">Not Applicable</option>
                                                    </select>
                                                    <select class="p-dropdown-label p-inputtext ng-star-inserted selectLabel" style="width: 100%;" [name]="col.title" [(ngModel)]="account[col.title]" *ngIf="col.title=='theirResidenceStatus'"  >
                                                        <option value="Resident">Resident</option>
                                                        <option value="Non Resident">Non Resident</option>
                                                        <option value="Not Applicable">Not Applicable</option>
                                                    </select>
                                                
                                                    <input pInputText [required]="col.required" [name]="col.title"
                                                    [type]="col.inpType" [(ngModel)]="account[col.title]" (change)="totaladdition(account,col,'PartD')"
                                                    [min]="1" style="width:100%" *ngIf="col.title!='noOfSharesHeld' && col.title!='residenceStatus' && col.title!='theirResidenceStatus'"   >
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{col.title=="createdDate"?(account[col.title] | date :
                                                'dd-MM-yyyy'):account[col.title]}}
                                            </ng-template>
                                        </p-cellEditor>
                                    </td>
                                    <td  *ngIf="!isView && !isChecker">
                                    <i class="pi pi-trash text-danger" (click)="delete(account,ri,'PartD')"></i>
                                    </td>
    
                            </ng-container>
                         </tr>
    
                    </ng-template>
                    </p-table>
                    </div>
                </p-tabView>
            </div>  
            <p style="font-weight: Bold;">Note :</p>
            <p style="font-size: 13px;">1 : For this return ‘Controller’ shareholder is defined as a shareholder (person or corporate) who, either alone or with any associate or associates is entitled to exercise or control the exercise of 15 percent or more of the voting power at any general meeting of the bank or the parent company of which the bank is a subsidiary</p>   
            <p style="font-size: 13px;">2. Significant shareholder is defined as a corporate or individual which/who individually or as controller of a group of shareholders, holds 5 percent or more of share capital or exercises 5 percent or more of voting power</p>
        </p-accordionTab>
      
    </p-accordion>
    
    <div class="row" style="padding-bottom:31px;padding-top: 25px;">
        <button pButton  (click)="gotoSection()" label="Next" icon="pi pi-check"    iconPos="left" class="mb-5" style="float:right;"></button>
        <button pButton type="button" label="Back" (click)="gotoReport('section1')"  class="p-button-raised p-button-secondary mr-2 mb-5"></button>
    </div>
    </div>
    <div *ngIf="section2Flag"  >
        <app-ownership-general-info-section2  (gotosection1generalInfo)="getSection2($event)" [ownershipInfo]="generalinfo"></app-ownership-general-info-section2>
    </div>
    <p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog>
    <p-toast position="top-right">
    </p-toast>